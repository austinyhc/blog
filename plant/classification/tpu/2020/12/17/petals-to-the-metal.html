<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Petals to the Metal | AUSTIN CAN HELP</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Petals to the Metal" />
<meta name="author" content="Austin Chen" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Getting Started with TPUs on Kaggle" />
<meta property="og:description" content="Getting Started with TPUs on Kaggle" />
<link rel="canonical" href="https://austinyhc.github.io/blog/plant/classification/tpu/2020/12/17/petals-to-the-metal.html" />
<meta property="og:url" content="https://austinyhc.github.io/blog/plant/classification/tpu/2020/12/17/petals-to-the-metal.html" />
<meta property="og:site_name" content="AUSTIN CAN HELP" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-17T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"Getting Started with TPUs on Kaggle","url":"https://austinyhc.github.io/blog/plant/classification/tpu/2020/12/17/petals-to-the-metal.html","@type":"BlogPosting","headline":"Petals to the Metal","dateModified":"2020-12-17T00:00:00-06:00","datePublished":"2020-12-17T00:00:00-06:00","author":{"@type":"Person","name":"Austin Chen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://austinyhc.github.io/blog/plant/classification/tpu/2020/12/17/petals-to-the-metal.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://austinyhc.github.io/blog/feed.xml" title="AUSTIN CAN HELP" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">AUSTIN CAN HELP</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Petals to the Metal</h1><p class="page-description">Getting Started with TPUs on Kaggle</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-12-17T00:00:00-06:00" itemprop="datePublished">
        Dec 17, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Austin Chen</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      16 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#plant">plant</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#classification">classification</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#tpu">tpu</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/austinyhc/blog/tree/master/_notebooks/2020-12-17-petals-to-the-metal.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          <div class="px-2">
    <a href="https://colab.research.google.com/github/austinyhc/blog/blob/master/_notebooks/2020-12-17-petals-to-the-metal.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Hyperparameters">Hyperparameters </a></li>
<li class="toc-entry toc-h1"><a href="#Data">Data </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Loading-data">Loading data </a></li>
<li class="toc-entry toc-h2"><a href="#Data-augmentation">Data augmentation </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Model">Model </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Batch-augmentation">Batch augmentation </a></li>
<li class="toc-entry toc-h2"><a href="#Building-a-model">Building a model </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Optimizer">Optimizer </a></li>
<li class="toc-entry toc-h1"><a href="#Callbacks">Callbacks </a></li>
<li class="toc-entry toc-h1"><a href="#Training">Training </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Train-the-normalization-layer">Train the normalization layer </a></li>
<li class="toc-entry toc-h2"><a href="#Train-all">Train all </a></li>
<li class="toc-entry toc-h2"><a href="#Training-curve">Training curve </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Prediction">Prediction </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-12-17-petals-to-the-metal.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">albumentations</span> <span class="k">as</span> <span class="nn">A</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">gc</span><span class="o">,</span> <span class="nn">cv2</span><span class="o">,</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">warnings</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">subprocess</span><span class="o">,</span> <span class="nn">pprint</span><span class="o">,</span> <span class="nn">pdb</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">backend</span> <span class="k">as</span> <span class="n">K</span>
<span class="kn">import</span> <span class="nn">tensorflow_hub</span> <span class="k">as</span> <span class="nn">hub</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span><span class="p">,</span><span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Using TensorFlow v</span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using TensorFlow v2.4.1
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-success">
    <svg class="octicon octicon-checklist" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 01.25-.25h8.5a.25.25 0 01.25.25v7.736a.75.75 0 101.5 0V1.75A1.75 1.75 0 0011.25 0h-8.5A1.75 1.75 0 001 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 000-1.5H2.75a.25.25 0 01-.25-.25V1.75zM4.75 4a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM4 7.75A.75.75 0 014.75 7h2a.75.75 0 010 1.5h-2A.75.75 0 014 7.75zm11.774 3.537a.75.75 0 00-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 00-1.062 1.058l1.943 1.95a.75.75 0 001.055.008l4.557-4.45z"></path></svg>
    <strong>Tip: </strong>Adding seed helps reproduce results. Setting debug parameter wil run the model on smaller number of epochs to validate the architecture.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">seed_everything</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'PYTHONHASHSEED'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'TF_DETERMINISTIC_OPS'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>

<span class="n">GOOGLE</span> <span class="o">=</span> <span class="s1">'google.colab'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">())</span>
<span class="n">KAGGLE</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">GOOGLE</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Running on </span><span class="si">{}</span><span class="s2">!"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
   <span class="s2">"Google Colab"</span> <span class="k">if</span> <span class="n">GOOGLE</span> <span class="k">else</span> <span class="s2">"Kaggle Kernel"</span>
<span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Running on Google Colab!
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Hyperparameters">
<a class="anchor" href="#Hyperparameters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hyperparameters<a class="anchor-link" href="#Hyperparameters"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">BASE_MODEL</span> <span class="o">=</span> <span class="s1">'efficientnet_b3'</span> <span class="c1">#@param ["'efficientnet_b3'", "'efficientnet_b4'", "'efficientnet_b2'"] {type:"raw", allow-input: true}</span>
<span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">300</span><span class="c1">#@param {type:"number"}</span>
<span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">300</span><span class="c1">#@param {type:"number"}</span>
<span class="n">CHANNELS</span> <span class="o">=</span> <span class="mi">3</span><span class="c1">#@param {type:"number"}</span>
<span class="n">IMG_SIZE</span> <span class="o">=</span> <span class="p">(</span><span class="n">HEIGHT</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">CHANNELS</span><span class="p">)</span>
<span class="n">EPOCHS</span> <span class="o">=</span>  <span class="mi">50</span><span class="c1">#@param {type:"number"}</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">*</span> <span class="n">strategy</span><span class="o">.</span><span class="n">num_replicas_in_sync</span> <span class="c1">#@param {type:"raw"}</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Use </span><span class="si">{}</span><span class="s2"> with input size </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">BASE_MODEL</span><span class="p">,</span> <span class="n">IMG_SIZE</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Train on batch size of </span><span class="si">{}</span><span class="s2"> for </span><span class="si">{}</span><span class="s2"> epochs"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">EPOCHS</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Use efficientnet_b3 with input size (300, 300, 3)
Train on batch size of 256 for 50 epochs
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data">
<a class="anchor" href="#Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data<a class="anchor-link" href="#Data"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loading-data">
<a class="anchor" href="#Loading-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Loading data<a class="anchor-link" href="#Loading-data"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">run_if</span> {GOOGLE}
#@title {run: "auto", display-mode: "form"}
GCS_PATH = 'gs://kds-c6b9829baa483a13a169c7cbe266341fb8c9b5ba36843af37a093a4c' #@param {type: "string"}
GCS_PATH += '/tfrecords-jpeg-512x512' #@param {type: "string"}
print(f"Sourcing images from {GCS_PATH}")
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sourcing images from gs://kds-c6b9829baa483a13a169c7cbe266341fb8c9b5ba36843af37a093a4c/tfrecords-jpeg-512x512
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CLASSES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'pink primrose'</span><span class="p">,</span>        <span class="s1">'hard-leaved pocket orchid'</span><span class="p">,</span> <span class="s1">'canterbury bells'</span><span class="p">,</span> <span class="s1">'sweet pea'</span><span class="p">,</span>     <span class="s1">'wild geranium'</span><span class="p">,</span>
           <span class="s1">'tiger lily'</span><span class="p">,</span>           <span class="s1">'moon orchid'</span><span class="p">,</span>               <span class="s1">'bird of paradise'</span><span class="p">,</span> <span class="s1">'monkshood'</span><span class="p">,</span>     <span class="s1">'globe thistle'</span><span class="p">,</span>        
           <span class="s1">'snapdragon'</span><span class="p">,</span>           <span class="s2">"colt's foot"</span><span class="p">,</span>               <span class="s1">'king protea'</span><span class="p">,</span>      <span class="s1">'spear thistle'</span><span class="p">,</span> <span class="s1">'yellow iris'</span><span class="p">,</span>
           <span class="s1">'globe-flower'</span><span class="p">,</span>         <span class="s1">'purple coneflower'</span><span class="p">,</span>         <span class="s1">'peruvian lily'</span><span class="p">,</span>    <span class="s1">'balloon flower'</span><span class="p">,</span><span class="s1">'giant white arum lily'</span><span class="p">,</span>
           <span class="s1">'fire lily'</span><span class="p">,</span>            <span class="s1">'pincushion flower'</span><span class="p">,</span>         <span class="s1">'fritillary'</span><span class="p">,</span>       <span class="s1">'red ginger'</span><span class="p">,</span>    <span class="s1">'grape hyacinth'</span><span class="p">,</span>
           <span class="s1">'corn poppy'</span><span class="p">,</span>           <span class="s1">'prince of wales feathers'</span><span class="p">,</span>  <span class="s1">'stemless gentian'</span><span class="p">,</span> <span class="s1">'artichoke'</span><span class="p">,</span>     <span class="s1">'sweet william'</span><span class="p">,</span>        
           <span class="s1">'carnation'</span><span class="p">,</span>            <span class="s1">'garden phlox'</span><span class="p">,</span>              <span class="s1">'love in the mist'</span><span class="p">,</span> <span class="s1">'cosmos'</span><span class="p">,</span>        <span class="s1">'alpine sea holly'</span><span class="p">,</span>
           <span class="s1">'ruby-lipped cattleya'</span><span class="p">,</span> <span class="s1">'cape flower'</span><span class="p">,</span>               <span class="s1">'great masterwort'</span><span class="p">,</span> <span class="s1">'siam tulip'</span><span class="p">,</span>    <span class="s1">'lenten rose'</span><span class="p">,</span>          
           <span class="s1">'barberton daisy'</span><span class="p">,</span>      <span class="s1">'daffodil'</span><span class="p">,</span>                  <span class="s1">'sword lily'</span><span class="p">,</span>       <span class="s1">'poinsettia'</span><span class="p">,</span>    <span class="s1">'bolero deep blue'</span><span class="p">,</span>
           <span class="s1">'wallflower'</span><span class="p">,</span>           <span class="s1">'marigold'</span><span class="p">,</span>                  <span class="s1">'buttercup'</span><span class="p">,</span>        <span class="s1">'daisy'</span><span class="p">,</span>         <span class="s1">'common dandelion'</span><span class="p">,</span>     
           <span class="s1">'petunia'</span><span class="p">,</span>              <span class="s1">'wild pansy'</span><span class="p">,</span>                <span class="s1">'primula'</span><span class="p">,</span>          <span class="s1">'sunflower'</span><span class="p">,</span>     <span class="s1">'lilac hibiscus'</span><span class="p">,</span>
           <span class="s1">'bishop of llandaff'</span><span class="p">,</span>   <span class="s1">'gaura'</span><span class="p">,</span>                     <span class="s1">'geranium'</span><span class="p">,</span>         <span class="s1">'orange dahlia'</span><span class="p">,</span> <span class="s1">'pink-yellow dahlia'</span><span class="p">,</span>   
           <span class="s1">'cautleya spicata'</span><span class="p">,</span>     <span class="s1">'japanese anemone'</span><span class="p">,</span>          <span class="s1">'black-eyed susan'</span><span class="p">,</span> <span class="s1">'silverbush'</span><span class="p">,</span>    <span class="s1">'californian poppy'</span><span class="p">,</span>
           <span class="s1">'osteospermum'</span><span class="p">,</span>         <span class="s1">'spring crocus'</span><span class="p">,</span>             <span class="s1">'iris'</span><span class="p">,</span>             <span class="s1">'windflower'</span><span class="p">,</span>    <span class="s1">'tree poppy'</span><span class="p">,</span>           
           <span class="s1">'gazania'</span><span class="p">,</span>              <span class="s1">'azalea'</span><span class="p">,</span>                    <span class="s1">'water lily'</span><span class="p">,</span>       <span class="s1">'rose'</span><span class="p">,</span>          <span class="s1">'thorn apple'</span><span class="p">,</span>
           <span class="s1">'morning glory'</span><span class="p">,</span>        <span class="s1">'passion flower'</span><span class="p">,</span>            <span class="s1">'lotus'</span><span class="p">,</span>            <span class="s1">'toad lily'</span><span class="p">,</span>     <span class="s1">'anthurium'</span><span class="p">,</span>
           <span class="s1">'frangipani'</span><span class="p">,</span>           <span class="s1">'clematis'</span><span class="p">,</span>                  <span class="s1">'hibiscus'</span><span class="p">,</span>         <span class="s1">'columbine'</span><span class="p">,</span>     <span class="s1">'desert-rose'</span><span class="p">,</span>
           <span class="s1">'tree mallow'</span><span class="p">,</span>          <span class="s1">'magnolia'</span><span class="p">,</span>                  <span class="s1">'cyclamen '</span><span class="p">,</span>        <span class="s1">'watercress'</span><span class="p">,</span>    <span class="s1">'canna lily'</span><span class="p">,</span>           
           <span class="s1">'hippeastrum '</span><span class="p">,</span>         <span class="s1">'bee balm'</span><span class="p">,</span>                  <span class="s1">'pink quill'</span><span class="p">,</span>       <span class="s1">'foxglove'</span><span class="p">,</span>      <span class="s1">'bougainvillea'</span><span class="p">,</span>
           <span class="s1">'camellia'</span><span class="p">,</span>             <span class="s1">'mallow'</span><span class="p">,</span>                    <span class="s1">'mexican petunia'</span><span class="p">,</span>  <span class="s1">'bromelia'</span><span class="p">,</span>      <span class="s1">'blanket flower'</span><span class="p">,</span>       
           <span class="s1">'trumpet creeper'</span><span class="p">,</span>      <span class="s1">'blackberry lily'</span><span class="p">,</span>           <span class="s1">'common tulip'</span><span class="p">,</span>     <span class="s1">'wild rose'</span><span class="p">]</span>

<span class="n">NCLASSES</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CLASSES</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of labels: </span><span class="si">{</span><span class="n">NCLASSES</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of labels: 104
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">decode_image</span><span class="p">(</span><span class="n">image_data</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">decode_jpeg</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="n">CHANNELS</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="k">if</span> <span class="n">GOOGLE</span>
                <span class="k">else</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">random_crop</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">IMG_SIZE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image</span>
    
<span class="k">def</span> <span class="nf">collate_labeled_tfrecord</span><span class="p">(</span><span class="n">example</span><span class="p">):</span>
    <span class="n">LABELED_TFREC_FORMAT</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"image"</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([],</span> <span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">),</span> <span class="c1"># tf.string means bytestring</span>
        <span class="s2">"class"</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>  <span class="c1"># shape [] means single element</span>
    <span class="p">}</span>
    <span class="n">example</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">parse_single_example</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">LABELED_TFREC_FORMAT</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">decode_image</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s1">'image'</span><span class="p">])</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s1">'class'</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">label</span>

<span class="k">def</span> <span class="nf">process_unlabeled_tfrecord</span><span class="p">(</span><span class="n">example</span><span class="p">):</span>
    <span class="n">UNLABELED_TFREC_FORMAT</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"image"</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([],</span> <span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">),</span> <span class="c1"># tf.string means bytestring</span>
        <span class="s2">"id"</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([],</span> <span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">),</span>    <span class="c1"># shape [] means single element</span>
    <span class="p">}</span>
    <span class="n">example</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">parse_single_example</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">UNLABELED_TFREC_FORMAT</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">decode_image</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s1">'image'</span><span class="p">])</span>
    <span class="n">idnum</span> <span class="o">=</span> <span class="n">example</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">idnum</span>

<span class="k">def</span> <span class="nf">count_data_items</span><span class="p">(</span><span class="n">filenames</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">"-([0-9]*)\."</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_filenames</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">gfile</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">GCS_PATH</span> <span class="o">+</span> <span class="s1">'/train/*.tfrec'</span><span class="p">)</span>
<span class="n">valid_filenames</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">gfile</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">GCS_PATH</span> <span class="o">+</span> <span class="s1">'/val/*.tfrec'</span><span class="p">)</span>
<span class="n">test_filenames</span>  <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">gfile</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">GCS_PATH</span> <span class="o">+</span> <span class="s1">'/test/*.tfrec'</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of train set: 12753
Number of valid set: 3712
Number of test set:  7382

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-augmentation">
<a class="anchor" href="#Data-augmentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data augmentation<a class="anchor-link" href="#Data-augmentation"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>The following data augmentation functions are referenced from <a href="https://www.kaggle.com/cdeotte/rotation-augmentation-gpu-tpu-0-96">Data Augmentation using GPU/TPU for Maximum Speed!</a> by <strong><em>@cdeotte</em></strong>
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transform_shear</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">shear</span><span class="p">):</span>
    <span class="c1"># input image - is one image of size [dim,dim,3] not a batch of [b,dim,dim,3]</span>
    <span class="c1"># output - image randomly sheared</span>
    <span class="n">DIM</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">XDIM</span> <span class="o">=</span> <span class="n">DIM</span><span class="o">%</span><span class="k">2</span> #fix for size 331
    
    <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span>
    <span class="n">shear</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">shear</span> <span class="o">/</span> <span class="mf">180.</span>
        
    <span class="c1"># SHEAR MATRIX</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span>
    <span class="n">zero</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">shear</span><span class="p">)</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">shear</span><span class="p">)</span>
    <span class="n">shear_matrix</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">one</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>    

    <span class="c1"># LIST DESTINATION PIXEL INDICES</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">DIM</span> <span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">),[</span><span class="n">DIM</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">DIM</span><span class="o">*</span><span class="n">DIM</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'int32'</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="p">)</span>
    
    <span class="c1"># ROTATE DESTINATION PIXELS ONTO ORIGIN PIXELS</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">shear_matrix</span><span class="p">,</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">))</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'int32'</span><span class="p">)</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="n">XDIM</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># FIND ORIGIN PIXEL VALUES </span>
    <span class="n">idx3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span> <span class="p">[</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="n">idx2</span><span class="p">[</span><span class="mi">0</span><span class="p">,],</span> <span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">idx2</span><span class="p">[</span><span class="mi">1</span><span class="p">,]]</span> <span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">idx3</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">d</span><span class="p">,[</span><span class="n">DIM</span><span class="p">,</span><span class="n">DIM</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transform_shift</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">h_shift</span><span class="p">,</span> <span class="n">w_shift</span><span class="p">):</span>
    <span class="c1"># input image - is one image of size [dim,dim,3] not a batch of [b,dim,dim,3]</span>
    <span class="c1"># output - image randomly shifted</span>
    <span class="n">DIM</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">XDIM</span> <span class="o">=</span> <span class="n">DIM</span><span class="o">%</span><span class="k">2</span> #fix for size 331
    
    <span class="n">height_shift</span> <span class="o">=</span> <span class="n">h_shift</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span> 
    <span class="n">width_shift</span> <span class="o">=</span> <span class="n">w_shift</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span> 
    <span class="n">one</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span>
    <span class="n">zero</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span>
        
    <span class="c1"># SHIFT MATRIX</span>
    <span class="n">shift_matrix</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">one</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span><span class="n">height_shift</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="p">,</span><span class="n">width_shift</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

    <span class="c1"># LIST DESTINATION PIXEL INDICES</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">DIM</span> <span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">),[</span><span class="n">DIM</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">DIM</span><span class="o">*</span><span class="n">DIM</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'int32'</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="p">)</span>
    
    <span class="c1"># ROTATE DESTINATION PIXELS ONTO ORIGIN PIXELS</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">shift_matrix</span><span class="p">,</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">))</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'int32'</span><span class="p">)</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="n">XDIM</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># FIND ORIGIN PIXEL VALUES </span>
    <span class="n">idx3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span> <span class="p">[</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="n">idx2</span><span class="p">[</span><span class="mi">0</span><span class="p">,],</span> <span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">idx2</span><span class="p">[</span><span class="mi">1</span><span class="p">,]]</span> <span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">idx3</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">d</span><span class="p">,[</span><span class="n">DIM</span><span class="p">,</span><span class="n">DIM</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transform_rotation</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">rotation</span><span class="p">):</span>
    <span class="c1"># input image - is one image of size [dim,dim,3] not a batch of [b,dim,dim,3]</span>
    <span class="c1"># output - image randomly rotated</span>
    <span class="n">DIM</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">XDIM</span> <span class="o">=</span> <span class="n">DIM</span><span class="o">%</span><span class="k">2</span> #fix for size 331
    
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span>
    <span class="c1"># CONVERT DEGREES TO RADIANS</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rotation</span> <span class="o">/</span> <span class="mf">180.</span>
    
    <span class="c1"># ROTATION MATRIX</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span>
    <span class="n">zero</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">)</span>
    <span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span> <span class="o">-</span><span class="n">s1</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

    <span class="c1"># LIST DESTINATION PIXEL INDICES</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">DIM</span> <span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">),[</span><span class="n">DIM</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">DIM</span><span class="o">*</span><span class="n">DIM</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'int32'</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="p">)</span>
    
    <span class="c1"># ROTATE DESTINATION PIXELS ONTO ORIGIN PIXELS</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">,</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span class="p">))</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'int32'</span><span class="p">)</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">idx2</span><span class="p">,</span><span class="o">-</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="n">XDIM</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># FIND ORIGIN PIXEL VALUES </span>
    <span class="n">idx3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span> <span class="p">[</span><span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="n">idx2</span><span class="p">[</span><span class="mi">0</span><span class="p">,],</span> <span class="n">DIM</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">idx2</span><span class="p">[</span><span class="mi">1</span><span class="p">,]]</span> <span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">idx3</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">d</span><span class="p">,[</span><span class="n">DIM</span><span class="p">,</span><span class="n">DIM</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">data_augment</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">p_rotation</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([],</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">p_spatial</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([],</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">p_rotate</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([],</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">p_pixel</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([],</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>    
    <span class="n">p_shear</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([],</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">p_shift</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([],</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">p_crop</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([],</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    
    <span class="c1"># Flips</span>
    <span class="k">if</span> <span class="n">p_spatial</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">random_flip_left_right</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">random_flip_up_down</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        
    <span class="c1"># Rotates</span>
    <span class="k">if</span> <span class="n">p_rotate</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">75</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># rotate 270º</span>
    <span class="k">elif</span> <span class="n">p_rotate</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># rotate 180º</span>
    <span class="k">elif</span> <span class="n">p_rotate</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">25</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># rotate 90º</span>
    
    <span class="k">if</span> <span class="n">p_rotation</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">3</span><span class="p">:</span> <span class="c1"># Rotation</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">transform_rotation</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">HEIGHT</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mf">45.</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p_shift</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">3</span><span class="p">:</span> <span class="c1"># Shift</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">transform_shift</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">HEIGHT</span><span class="p">,</span> <span class="n">h_shift</span><span class="o">=</span><span class="mf">15.</span><span class="p">,</span> <span class="n">w_shift</span><span class="o">=</span><span class="mf">15.</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p_shear</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">3</span><span class="p">:</span> <span class="c1"># Shear</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">transform_shear</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">HEIGHT</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="mf">20.</span><span class="p">)</span>
        
    <span class="c1"># Crops</span>
    <span class="k">if</span> <span class="n">p_crop</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">4</span><span class="p">:</span>
        <span class="n">crop_size</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([],</span> <span class="nb">int</span><span class="p">(</span><span class="n">HEIGHT</span><span class="o">*.</span><span class="mi">7</span><span class="p">),</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">random_crop</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">crop_size</span><span class="p">,</span> <span class="n">crop_size</span><span class="p">,</span> <span class="n">CHANNELS</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">p_crop</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">7</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p_crop</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">9</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">central_crop</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">central_fraction</span><span class="o">=.</span><span class="mi">7</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">p_crop</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">8</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">central_crop</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">central_fraction</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">central_crop</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">central_fraction</span><span class="o">=.</span><span class="mi">9</span><span class="p">)</span>
            
    <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">HEIGHT</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">])</span>
        
    <span class="c1"># Pixel-level transforms</span>
    <span class="k">if</span> <span class="n">p_pixel</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p_pixel</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">8</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">random_saturation</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">p_pixel</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">6</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">random_contrast</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lower</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">p_pixel</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">4</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">random_brightness</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">max_delta</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">adjust_gamma</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=.</span><span class="mi">6</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">label</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-success">
    <svg class="octicon octicon-checklist octicon octicon-checklist" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 01.25-.25h8.5a.25.25 0 01.25.25v7.736a.75.75 0 101.5 0V1.75A1.75 1.75 0 0011.25 0h-8.5A1.75 1.75 0 001 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 000-1.5H2.75a.25.25 0 01-.25-.25V1.75zM4.75 4a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM4 7.75A.75.75 0 014.75 7h2a.75.75 0 010 1.5h-2A.75.75 0 014 7.75zm11.774 3.537a.75.75 0 00-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 00-1.062 1.058l1.943 1.95a.75.75 0 001.055.008l4.557-4.45z"></path></svg>
    <strong>Tip: </strong><code>experimental_deterministic</code> is set to decide whether the outputs need to be produced in deterministic order. Default: <code>True</code>
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">option_no_order</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
<span class="n">option_no_order</span><span class="o">.</span><span class="n">experimental_deterministic</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span><span class="n">train_filenames</span><span class="p">,</span> <span class="n">num_parallel_reads</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_ds</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">collate_labeled_tfrecord</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">data_augment</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">repeat</span><span class="p">()</span>
            <span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
            <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span><span class="n">valid_filenames</span><span class="p">,</span> <span class="n">num_parallel_reads</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">valid_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">valid_ds</span>
            <span class="o">.</span><span class="n">with_options</span><span class="p">(</span><span class="n">option_no_order</span><span class="p">)</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">collate_labeled_tfrecord</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">cache</span><span class="p">()</span>
            <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span><span class="n">test_filenames</span><span class="p">,</span> <span class="n">num_parallel_reads</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_ds</span>
            <span class="o">.</span><span class="n">with_options</span><span class="p">(</span><span class="n">option_no_order</span><span class="p">)</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">process_unlabeled_tfrecord</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Model">
<a class="anchor" href="#Model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model<a class="anchor-link" href="#Model"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Batch-augmentation">
<a class="anchor" href="#Batch-augmentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Batch augmentation<a class="anchor-link" href="#Batch-augmentation"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Augmentation can be applied in two ways.</p>
<ul>
<li>Using the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/experimental/preprocessing/">Keras Preprocessing Layers</a>
</li>
<li>Using the <code>tf.image</code>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-warn">
    <svg class="octicon octicon-zap" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 00-.01.004L3.286 8.571A.25.25 0 003.462 9H6.75a.75.75 0 01.694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0012.538 7H9.25a.75.75 0 01-.683-1.06l2.008-4.418.003-.006a.02.02 0 00-.004-.009.02.02 0 00-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 012.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 01-.871.354h-.302a1.25 1.25 0 01-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"></path></svg>
    <strong>Important: </strong>The <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/experimental/preprocessing/">Keras Preprocessing Layers</a> are currently experimental so it seems it does not have supporting TPU OpKernel yet.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#batch_augment = tf.keras.Sequential(</span>
<span class="c1">#    [</span>
<span class="c1">#     tf.keras.layers.experimental.preprocessing.RandomCrop(*IMG_SIZE),</span>
<span class="c1">#     tf.keras.layers.experimental.preprocessing.RandomFlip("horizontal_and_vertical"),</span>
<span class="c1">#     tf.keras.layers.experimental.preprocessing.RandomRotation(0.25),</span>
<span class="c1">#     tf.keras.layers.experimental.preprocessing.RandomZoom((-0.2, 0)),</span>
<span class="c1">#     tf.keras.layers.experimental.preprocessing.RandomContrast((0.2,0.2))</span>
<span class="c1">#    ]</span>
<span class="c1">#)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#func = lambda x,y: (batch_augment(x), y)</span>
<span class="c1">#x = (train_ds</span>
<span class="c1">#     .take(1)</span>
<span class="c1">#     .map(func, num_parallel_calls=AUTOTUNE))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-a-model">
<a class="anchor" href="#Building-a-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Building a model<a class="anchor-link" href="#Building-a-model"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we're ready to create a neural network for classifying images! We'll use what's known as <em>transfer learning</em>. With transfer learning, you reuse the body part of a pretrained model and replace its' head or tail with custom layers depending on the problem that we are solving.</p>
<p>For this tutorial, we'll use <code>EfficientNetb3</code> which is pretrained on ImageNet. Later, I might want to experiment with other models. (Xception wouldn't be a bad choice.)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-warn">
    <svg class="octicon octicon-zap octicon octicon-zap" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 00-.01.004L3.286 8.571A.25.25 0 003.462 9H6.75a.75.75 0 01.694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0012.538 7H9.25a.75.75 0 01-.683-1.06l2.008-4.418.003-.006a.02.02 0 00-.004-.009.02.02 0 00-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 012.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 01-.871.354h-.302a1.25 1.25 0 01-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"></path></svg>
    <strong>Important: </strong>The distribution strategy we created earilier contains a context manager, <code>straategy.scope</code>. This context manager tells TensorFlow how to divide the work of training among the eight TPU cores. When using TensorFlow with a TPU, it’s important to define your model in <code>strategy.sceop()</code> context.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">run_if</span> {GOOGLE}
from tensorflow.keras.applications import EfficientNetB3
from tensorflow.keras.applications import VGG16
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="n">base_model</span><span class="p">,</span> <span class="n">num_class</span><span class="p">):</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">IMG_SIZE</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">base_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_class</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"softmax"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"pred"</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">strategy</span><span class="o">.</span><span class="n">scope</span><span class="p">():</span>
    <span class="n">efficientnet</span> <span class="o">=</span> <span class="n">EfficientNetB3</span><span class="p">(</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="s1">'imagenet'</span> <span class="k">if</span> <span class="n">TRAIN</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> 
        <span class="n">include_top</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
        <span class="n">input_shape</span> <span class="o">=</span> <span class="n">IMG_SIZE</span><span class="p">,</span> 
        <span class="n">pooling</span><span class="o">=</span><span class="s1">'avg'</span><span class="p">)</span>
    <span class="n">efficientnet</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">base_model</span><span class="o">=</span><span class="n">efficientnet</span><span class="p">,</span> <span class="n">num_class</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">CLASSES</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Optimizer">
<a class="anchor" href="#Optimizer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optimizer<a class="anchor-link" href="#Optimizer"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-warn">
    <svg class="octicon octicon-zap octicon octicon-zap octicon octicon-zap" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 00-.01.004L3.286 8.571A.25.25 0 003.462 9H6.75a.75.75 0 01.694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0012.538 7H9.25a.75.75 0 01-.683-1.06l2.008-4.418.003-.006a.02.02 0 00-.004-.009.02.02 0 00-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 012.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 01-.871.354h-.302a1.25 1.25 0 01-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"></path></svg>
    <strong>Important: </strong>I always wanted to try the new <code>CosineDecayRestarts</code> function implemented in <code>tf.keras</code> as it seemed promising and I struggled to find the right settings (if there were any) for the <code>ReduceLROnPlateau</code>
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">STEPS</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">count_data_items</span><span class="p">(</span><span class="n">train_filenames</span><span class="p">)</span> <span class="o">/</span> <span class="n">BATCH_SIZE</span><span class="p">)</span> <span class="o">*</span> <span class="n">EPOCHS</span>
<span class="n">LR_START</span> <span class="o">=</span> <span class="mf">1e-4</span> <span class="c1">#@param {type: "number"}</span>
<span class="n">LR_START</span> <span class="o">*=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">num_replicas_in_sync</span>
<span class="n">LR_MIN</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="c1">#@param {type: "number"}</span>
<span class="n">N_RESTARTS</span> <span class="o">=</span>  <span class="mi">5</span><span class="c1">#@param {type: "number"}</span>
<span class="n">T_MUL</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1">#@param {type: "number"}</span>
<span class="n">M_MUL</span> <span class="o">=</span>  <span class="mi">1</span><span class="c1">#@param {type: "number"}</span>
<span class="n">STEPS_START</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">T_MUL</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T_MUL</span><span class="o">**</span><span class="p">(</span><span class="n">N_RESTARTS</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">STEPS</span><span class="p">)</span>

<span class="n">schedule</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">CosineDecayRestarts</span><span class="p">(</span>
    <span class="n">first_decay_steps</span><span class="o">=</span><span class="n">STEPS_START</span><span class="p">,</span>
    <span class="n">initial_learning_rate</span><span class="o">=</span><span class="n">LR_START</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">LR_MIN</span><span class="p">,</span>
    <span class="n">m_mul</span><span class="o">=</span><span class="n">M_MUL</span><span class="p">,</span>
    <span class="n">t_mul</span><span class="o">=</span><span class="n">T_MUL</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">STEPS</span><span class="p">)]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">schedule</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">STEPS</span><span class="p">)]</span>

<span class="n">_</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">'#F0F0F0'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'#F8F8F8'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'iteration'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'learning rate'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="si">{:d}</span><span class="s1"> total epochs and </span><span class="si">{:d}</span><span class="s1"> steps per epoch'</span>
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">EPOCHS</span><span class="p">,</span> <span class="n">STEPS</span> <span class="o">//</span> <span class="n">EPOCHS</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">schedule</span><span class="o">.</span><span class="n">get_config</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>50 total epochs and 50 steps per epoch
{'initial_learning_rate': 0.0008, 'first_decay_steps': 40, 't_mul': 2.0, 'm_mul': 1, 'alpha': 1e-05, 'name': None}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Callbacks">
<a class="anchor" href="#Callbacks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Callbacks<a class="anchor-link" href="#Callbacks"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span>
        <span class="n">filepath</span><span class="o">=</span><span class="s1">'001_best_model.h5'</span><span class="p">,</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s1">'val_loss'</span><span class="p">,</span>
        <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s1">'val_loss'</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">'min'</span><span class="p">,</span>
        <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">]</span>
    
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">schedule</span><span class="p">),</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="s1">'sparse_categorical_crossentropy'</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'sparse_categorical_accuracy'</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, 300, 300, 3)]     0         
_________________________________________________________________
efficientnetb3 (Functional)  (None, 1536)              10783535  
_________________________________________________________________
dropout (Dropout)            (None, 1536)              0         
_________________________________________________________________
pred (Dense)                 (None, 104)               159848    
=================================================================
Total params: 10,943,383
Trainable params: 10,856,080
Non-trainable params: 87,303
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training">
<a class="anchor" href="#Training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training<a class="anchor-link" href="#Training"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-the-normalization-layer">
<a class="anchor" href="#Train-the-normalization-layer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Train the <code>normalization</code> layer<a class="anchor-link" href="#Train-the-normalization-layer"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">run_if</span> {GOOGLE}
def generate_norm_image(example):
    LABELED_TFREC_FORMAT = {
        "image": tf.io.FixedLenFeature([], tf.string), # tf.string means bytestring
        "class": tf.io.FixedLenFeature([], tf.int64),  # shape [] means single element
    }
    example = tf.io.parse_single_example(example, LABELED_TFREC_FORMAT)
    image = decode_image(example['image'])
    image = image / 255.0
    return image
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">run_if</span> {GOOGLE}
if os.path.exists("000_normalization.h5"):
    model.load_weights("000_normalization.h5")
else:
    adapt_ds = (tf.data.TFRecordDataset(train_filenames, num_parallel_reads=AUTOTUNE)
                    .map(generate_norm_image, num_parallel_calls=AUTOTUNE)
                    .shuffle(2048)
                    .batch(BATCH_SIZE)
                    .prefetch(AUTOTUNE))
    model.get_layer('efficientnetb3').get_layer('normalization').adapt(adapt_ds)
    model.save_weights("000_normalization.h5")
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-all">
<a class="anchor" href="#Train-all" aria-hidden="true"><span class="octicon octicon-link"></span></a>Train all<a class="anchor-link" href="#Train-all"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">train_ds</span><span class="p">,</span>
    <span class="n">validation_data</span><span class="o">=</span><span class="n">valid_ds</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span>
    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">STEPS</span><span class="o">//</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/50
9/9 - 156s - loss: 1.9010 - sparse_categorical_accuracy: 0.5043 - val_loss: 13.0768 - val_sparse_categorical_accuracy: 0.2594
Epoch 2/50
9/9 - 6s - loss: 1.6419 - sparse_categorical_accuracy: 0.5647 - val_loss: 6.8306 - val_sparse_categorical_accuracy: 0.3257
Epoch 3/50
9/9 - 6s - loss: 1.5901 - sparse_categorical_accuracy: 0.5864 - val_loss: 3.9058 - val_sparse_categorical_accuracy: 0.4119
Epoch 4/50
9/9 - 6s - loss: 1.5140 - sparse_categorical_accuracy: 0.5877 - val_loss: 2.9674 - val_sparse_categorical_accuracy: 0.4723
Epoch 5/50
9/9 - 10s - loss: 1.5115 - sparse_categorical_accuracy: 0.5959 - val_loss: 2.2275 - val_sparse_categorical_accuracy: 0.5275
Epoch 6/50
9/9 - 7s - loss: 1.4713 - sparse_categorical_accuracy: 0.6050 - val_loss: 1.6515 - val_sparse_categorical_accuracy: 0.6051
Epoch 7/50
9/9 - 7s - loss: 1.4460 - sparse_categorical_accuracy: 0.6155 - val_loss: 1.3832 - val_sparse_categorical_accuracy: 0.6360
Epoch 8/50
9/9 - 7s - loss: 1.3661 - sparse_categorical_accuracy: 0.6337 - val_loss: 1.3275 - val_sparse_categorical_accuracy: 0.6509
Epoch 9/50
9/9 - 6s - loss: 1.3910 - sparse_categorical_accuracy: 0.6215 - val_loss: 1.2825 - val_sparse_categorical_accuracy: 0.6608
Epoch 10/50
9/9 - 6s - loss: 1.2811 - sparse_categorical_accuracy: 0.6562 - val_loss: 1.2094 - val_sparse_categorical_accuracy: 0.6797
Epoch 11/50
9/9 - 6s - loss: 1.2926 - sparse_categorical_accuracy: 0.6484 - val_loss: 1.1464 - val_sparse_categorical_accuracy: 0.6950
Epoch 12/50
9/9 - 6s - loss: 1.2898 - sparse_categorical_accuracy: 0.6302 - val_loss: 1.1089 - val_sparse_categorical_accuracy: 0.7050
Epoch 13/50
9/9 - 6s - loss: 1.2204 - sparse_categorical_accuracy: 0.6784 - val_loss: 1.0893 - val_sparse_categorical_accuracy: 0.7096
Epoch 14/50
9/9 - 6s - loss: 1.2152 - sparse_categorical_accuracy: 0.6623 - val_loss: 1.0783 - val_sparse_categorical_accuracy: 0.7142
Epoch 15/50
9/9 - 6s - loss: 1.2462 - sparse_categorical_accuracy: 0.6576 - val_loss: 1.0587 - val_sparse_categorical_accuracy: 0.7217
Epoch 16/50
9/9 - 6s - loss: 1.2206 - sparse_categorical_accuracy: 0.6688 - val_loss: 0.9961 - val_sparse_categorical_accuracy: 0.7314
Epoch 17/50
9/9 - 7s - loss: 1.2518 - sparse_categorical_accuracy: 0.6636 - val_loss: 1.0047 - val_sparse_categorical_accuracy: 0.7368
Epoch 18/50
9/9 - 7s - loss: 1.1942 - sparse_categorical_accuracy: 0.6727 - val_loss: 0.9873 - val_sparse_categorical_accuracy: 0.7384
Epoch 19/50
9/9 - 9s - loss: 1.1119 - sparse_categorical_accuracy: 0.7010 - val_loss: 0.9598 - val_sparse_categorical_accuracy: 0.7395
Epoch 20/50
9/9 - 7s - loss: 1.1494 - sparse_categorical_accuracy: 0.6944 - val_loss: 0.9371 - val_sparse_categorical_accuracy: 0.7532
Epoch 21/50
9/9 - 7s - loss: 1.1256 - sparse_categorical_accuracy: 0.6879 - val_loss: 0.9200 - val_sparse_categorical_accuracy: 0.7627
Epoch 22/50
9/9 - 6s - loss: 1.0482 - sparse_categorical_accuracy: 0.7201 - val_loss: 0.8943 - val_sparse_categorical_accuracy: 0.7694
Epoch 23/50
9/9 - 6s - loss: 1.0809 - sparse_categorical_accuracy: 0.7153 - val_loss: 0.9161 - val_sparse_categorical_accuracy: 0.7648
Epoch 24/50
9/9 - 6s - loss: 1.0814 - sparse_categorical_accuracy: 0.7114 - val_loss: 0.9213 - val_sparse_categorical_accuracy: 0.7619
Epoch 25/50
9/9 - 6s - loss: 1.0078 - sparse_categorical_accuracy: 0.7214 - val_loss: 0.8947 - val_sparse_categorical_accuracy: 0.7675
Epoch 26/50
9/9 - 7s - loss: 0.9709 - sparse_categorical_accuracy: 0.7391 - val_loss: 0.8600 - val_sparse_categorical_accuracy: 0.7753
Epoch 27/50
9/9 - 6s - loss: 1.0287 - sparse_categorical_accuracy: 0.7270 - val_loss: 0.8354 - val_sparse_categorical_accuracy: 0.7872
Epoch 28/50
9/9 - 6s - loss: 0.9749 - sparse_categorical_accuracy: 0.7396 - val_loss: 0.8162 - val_sparse_categorical_accuracy: 0.7920
Epoch 29/50
9/9 - 6s - loss: 0.9431 - sparse_categorical_accuracy: 0.7383 - val_loss: 0.8065 - val_sparse_categorical_accuracy: 0.7939
Epoch 30/50
9/9 - 7s - loss: 0.9715 - sparse_categorical_accuracy: 0.7422 - val_loss: 0.7995 - val_sparse_categorical_accuracy: 0.7936
Epoch 31/50
9/9 - 7s - loss: 0.9164 - sparse_categorical_accuracy: 0.7530 - val_loss: 0.7948 - val_sparse_categorical_accuracy: 0.7947
Epoch 32/50
9/9 - 6s - loss: 0.9203 - sparse_categorical_accuracy: 0.7487 - val_loss: 0.8642 - val_sparse_categorical_accuracy: 0.7683
Epoch 33/50
9/9 - 7s - loss: 0.9915 - sparse_categorical_accuracy: 0.7313 - val_loss: 0.8313 - val_sparse_categorical_accuracy: 0.7823
Epoch 34/50
9/9 - 6s - loss: 1.0157 - sparse_categorical_accuracy: 0.7296 - val_loss: 0.8204 - val_sparse_categorical_accuracy: 0.7842
Epoch 35/50
9/9 - 7s - loss: 1.0600 - sparse_categorical_accuracy: 0.7188 - val_loss: 0.8281 - val_sparse_categorical_accuracy: 0.7866
Epoch 36/50
9/9 - 6s - loss: 0.9717 - sparse_categorical_accuracy: 0.7361 - val_loss: 0.8413 - val_sparse_categorical_accuracy: 0.7761
Epoch 37/50
9/9 - 7s - loss: 0.9517 - sparse_categorical_accuracy: 0.7326 - val_loss: 0.8223 - val_sparse_categorical_accuracy: 0.7839
Epoch 38/50
9/9 - 7s - loss: 0.8959 - sparse_categorical_accuracy: 0.7626 - val_loss: 0.7921 - val_sparse_categorical_accuracy: 0.7874
Epoch 39/50
9/9 - 7s - loss: 1.0345 - sparse_categorical_accuracy: 0.7196 - val_loss: 0.7694 - val_sparse_categorical_accuracy: 0.8036
Epoch 40/50
9/9 - 7s - loss: 0.9000 - sparse_categorical_accuracy: 0.7465 - val_loss: 0.7594 - val_sparse_categorical_accuracy: 0.8036
Epoch 41/50
9/9 - 7s - loss: 0.8503 - sparse_categorical_accuracy: 0.7626 - val_loss: 0.7567 - val_sparse_categorical_accuracy: 0.8012
Epoch 42/50
9/9 - 6s - loss: 0.8809 - sparse_categorical_accuracy: 0.7530 - val_loss: 0.7373 - val_sparse_categorical_accuracy: 0.8082
Epoch 43/50
9/9 - 6s - loss: 0.9019 - sparse_categorical_accuracy: 0.7539 - val_loss: 0.7463 - val_sparse_categorical_accuracy: 0.8106
Epoch 44/50
9/9 - 6s - loss: 0.8453 - sparse_categorical_accuracy: 0.7674 - val_loss: 0.7092 - val_sparse_categorical_accuracy: 0.8155
Epoch 45/50
9/9 - 7s - loss: 0.7987 - sparse_categorical_accuracy: 0.7687 - val_loss: 0.7131 - val_sparse_categorical_accuracy: 0.8152
Epoch 46/50
9/9 - 6s - loss: 0.8338 - sparse_categorical_accuracy: 0.7769 - val_loss: 0.7005 - val_sparse_categorical_accuracy: 0.8171
Epoch 47/50
9/9 - 7s - loss: 0.7969 - sparse_categorical_accuracy: 0.7799 - val_loss: 0.6921 - val_sparse_categorical_accuracy: 0.8230
Epoch 48/50
9/9 - 6s - loss: 0.7685 - sparse_categorical_accuracy: 0.7891 - val_loss: 0.6948 - val_sparse_categorical_accuracy: 0.8198
Epoch 49/50
9/9 - 7s - loss: 0.7290 - sparse_categorical_accuracy: 0.7986 - val_loss: 0.6804 - val_sparse_categorical_accuracy: 0.8254
Epoch 50/50
9/9 - 7s - loss: 0.7546 - sparse_categorical_accuracy: 0.7925 - val_loss: 0.6556 - val_sparse_categorical_accuracy: 0.8349
</pre>
</div>
</div>

</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-curve">
<a class="anchor" href="#Training-curve" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training curve<a class="anchor-link" href="#Training-curve"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">show_history</span><span class="p">(</span><span class="n">history</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'loss'</span><span class="p">,</span> <span class="s1">'accuracy'</span><span class="p">]</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">history</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">k</span><span class="p">}</span> <span class="k">for</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">topics</span><span class="p">]</span>
    <span class="n">_</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">'#F0F0F0'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">topic</span><span class="p">,</span><span class="n">group</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">topics</span><span class="p">,</span><span class="n">groups</span><span class="p">,</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'#F8F8F8'</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s1"> over epochs'</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'epoch'</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'train'</span><span class="p">,</span> <span class="s1">'valid'</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_history</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">show_confusion_matrix</span><span class="p">(</span><span class="n">cmat</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">):</span>
    <span class="n">_</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">'#F0F0F0'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">cmat</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Blues'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">CLASSES</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CLASSES</span><span class="p">)),)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">CLASSES</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">'fontsize'</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">"left"</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s2">"anchor"</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CLASSES</span><span class="p">)))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">CLASSES</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">'fontsize'</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">"right"</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s2">"anchor"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>

    <span class="n">textstr</span> <span class="o">=</span> <span class="s2">""</span>
    <span class="k">if</span> <span class="n">precision</span><span class="p">:</span> <span class="n">textstr</span> <span class="o">+=</span> <span class="s1">'precision = </span><span class="si">{:.3f}</span><span class="s1"> '</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">recall</span><span class="p">:</span> <span class="n">textstr</span> <span class="o">+=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">recall = </span><span class="si">{:.3f}</span><span class="s1"> '</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">score</span><span class="p">:</span> <span class="n">textstr</span> <span class="o">+=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">f1 = </span><span class="si">{:.3f}</span><span class="s1"> '</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">textstr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">'round'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'wheat'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">'top'</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ordered_valid_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span><span class="n">valid_filenames</span><span class="p">,</span> <span class="n">num_parallel_reads</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">ordered_valid_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">ordered_valid_ds</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">collate_labeled_tfrecord</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">cache</span><span class="p">()</span>
            <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">))</span>

<span class="n">x_valid_ds</span> <span class="o">=</span> <span class="n">ordered_valid_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">y_valid_ds</span> <span class="o">=</span> <span class="n">ordered_valid_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_valid_ds</span>
        <span class="o">.</span><span class="n">unbatch</span><span class="p">()</span>
        <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">count_data_items</span><span class="p">(</span><span class="n">valid_filenames</span><span class="p">))</span>
        <span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">()</span>
        <span class="o">.</span><span class="n">next</span><span class="p">())</span>
<span class="n">y_probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_valid_ds</span><span class="p">)</span>
<span class="n">y_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">label_ids</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CLASSES</span><span class="p">))</span>
<span class="n">cmatrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">label_ids</span><span class="p">)</span>
<span class="n">cmatrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cmatrix</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">cmatrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span> <span class="c1"># normalize</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You might be familiar with metrics like <a href="https://en.wikipedia.org/wiki/F1_score">F1-score</a> or <a href="https://en.wikipedia.org/wiki/Precision_and_recall">precision and recall</a>. This cell will compute these metrics and display them with a plot of the confusion matrix. (These metrics are defined in the Scikit-learn module <code>sklearn.metrics</code>; we've imported them in the helper script for you.)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">label_ids</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'macro'</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">label_ids</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'macro'</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">label_ids</span><span class="p">,</span><span class="n">average</span><span class="o">=</span><span class="s1">'macro'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_confusion_matrix</span><span class="p">(</span><span class="n">cmatrix</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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u7jvvgdixowT22v33fdATM35k4GIiBXLV6zS1FPR/83/f2tT1ts9++z/xKiRIyPizb/zfPyx33VYPvPcC2LhwoVx2aUXx4QJ4/NfUDcnaAJAD/aPf8yLU089I44++sj43//9v/j616+I0087pdPnnHzySbHb+/aKE06cEUcecXgMHTokfvv4/8T99/46Zl741agZMiQOOfzI+PpXL4ox6w+NnXbaId745z/j6aefiaM/feQq67vhhpuiuaU5Jm87KYYMGRK33npbVFVVZU7fU1NTE58+6oj44llfivXXXy8mTBgfV8y6KhYseC1z3V2xtl+df/a4Y+L9e+0bl1xyWey3375x5513xYMP/TbuvfeX7Y85++yZ8cQTT8UvfvFmx/20aXvFFbO+GV++8Ktx0McOiCVLlsY5XzovNtjgHfHe974nIiJmzboqxo0fF1tsvlk0NjbGLbf8KH72s5/HTTddHxFv7pMtt9yiw1jWHTYsmpubV6n3NN02aDY05d9GKa+7vPb952fW63/9xcw60D3kvd8HVHXfTl/oLqZPPzBaWlti1932jH79+sWnDj0kTjjhuE6fs/XWW8U99/w8Zs68IPae9sFoaWmJiRPGx34f+mBMGPHm1+zfuOS8GD9meFz0lYvjlRNfjbq6EfGJT3w8c33D1h0Wl176jTjzzLOiqak5Ntts07j55utzP4k7//wvRUTEscceHwsXLYp3v/td8dM7ftyh47wcpk6dEtd//9qYee4Fcd75F8aGG06M66//bmw3edv2x8ybNz9emDu3/f93222XuO57V8dlX78iLrvs8hg0aGBMnrxt/PSOW9v/bKCxsTG+8IWz45VXXo1BgwbG5ptvFrf95Icxbdpehb/GovVbuHBhW97CATXl+4PUzoJm3g8fQRN6JkETOrdkyZL4x0t/jXduPLFDfe9pH4wtttg8Lrv04jKNjO7in/+sj8XLW2LihhuXZfsNyxZl1k3YDgBAEoImAABJdNu/0QQAOnf3r+4q9xCgUz7RBAAgiW77ieaaNAHkNf1s+rmf5T6ns3uqk87CZY2Z9XVrqsu6LspD0w+rY2VjdtNYd74PeW/10EMPx7R99ovnn/9zrL/++vHb3z4c++23fzz//J9j9Khi78xD9+YTTQCgR7jjjjtjm0lTY93akbHNpKnx0zs7/9OB8y+4KAbX1Gb+W7Dg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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Prediction">
<a class="anchor" href="#Prediction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prediction<a class="anchor-link" href="#Prediction"> </a>
</h1>
<p>Once you're satisfied with everything, you're ready to make predictions on the test set.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_ds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span><span class="n">test_filenames</span><span class="p">,</span> <span class="n">num_parallel_reads</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_ds</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">process_unlabeled_tfrecord</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">AUTOTUNE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">))</span>
            
<span class="n">x_test_ds</span> <span class="o">=</span> <span class="n">test_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">image</span><span class="p">,</span><span class="n">idnum</span><span class="p">:</span> <span class="n">image</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_ds</span><span class="p">)</span>
<span class="n">y_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's generate a file <code>submission.csv</code>. This file is what you'll submit to get your score on the leaderboard.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">id_test_ds</span> <span class="o">=</span> <span class="n">test_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">image</span><span class="p">,</span><span class="n">idnum</span><span class="p">:</span> <span class="n">idnum</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">id_test_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">id_test_ds</span><span class="o">.</span><span class="n">unbatch</span><span class="p">()</span>
           <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">count_data_items</span><span class="p">(</span><span class="n">test_filenames</span><span class="p">))</span>
           <span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">()</span>
           <span class="o">.</span><span class="n">next</span><span class="p">()</span>
           <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'U'</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">'submission.csv'</span><span class="p">,</span>
           <span class="n">np</span><span class="o">.</span><span class="n">rec</span><span class="o">.</span><span class="n">fromarrays</span><span class="p">([</span><span class="n">id_test_ds</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">]),</span>
           <span class="n">fmt</span><span class="o">=</span><span class="p">[</span><span class="s1">'</span><span class="si">%s</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'</span><span class="si">%d</span><span class="s1">'</span><span class="p">],</span>
           <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span>
           <span class="n">header</span><span class="o">=</span><span class="s1">'id,label'</span><span class="p">,</span>
           <span class="n">comments</span><span class="o">=</span><span class="s1">''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head submission.csv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>id,label
252d840db,67
1c4736dea,28
c37a6f3e9,83
00e4f514e,103
59d1b6146,46
8d808a07b,53
aeb67eefb,52
53cfc6586,71
aaa580243,85
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/blog/plant/classification/tpu/2020/12/17/petals-to-the-metal.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Thoughts when I am building</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/austinyhc" title="austinyhc"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/austinyht" title="austinyht"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
